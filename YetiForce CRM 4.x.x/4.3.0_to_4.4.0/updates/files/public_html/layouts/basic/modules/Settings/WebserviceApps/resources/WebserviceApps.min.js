
jQuery.Class("Settings_WebserviceApps_Index_Js",{},{registerTableEvents:function(){var b=this;var a=$(".configContainer");a.find(".edit").on("click",function(f){var d=$(f.currentTarget);var c=d.closest("tr");b.showFormToEditKey(c.data("id"))});a.find(".remove").on("click",function(g){var f=jQuery(g.currentTarget);var c=f.closest("tr");var d=app.vtranslate("JS_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:d}).then(function(i){var j={module:app.getModuleName(),parent:app.getParentModuleName(),action:"Delete",id:c.data("id")};var h=jQuery.progressIndicator();AppConnector.request(j).then(function(e){h.progressIndicator({mode:"hide"});b.loadTable()})},function(e,h){})})},loadTable:function(){var b=this;var c={module:app.getModuleName(),parent:app.getParentModuleName(),view:"Index",};var a=jQuery.progressIndicator();AppConnector.request(c).then(function(d){a.progressIndicator({mode:"hide"});$(".configContainer").html(d);b.registerTableEvents()})},showFormToEditKey:function(d){var b=this;var c={module:app.getModuleName(),parent:app.getParentModuleName(),view:"CreateApp",};if(d!=""){c.record=d}var a=jQuery.progressIndicator();AppConnector.request(c).then(function(e){a.progressIndicator({mode:"hide"});app.showModalWindow(e,function(f){const h=f.find(".previewPassword");const g=f.find('[name="pass"]');h.on("mousedown",function(k){g.attr("type","text")});h.on("mouseup",function(k){g.attr("type","password")});h.on("mouseout",function(k){g.attr("type","password")});const j=App.Fields.Password.registerCopyClipboard(".copyPassword");f.one("hidden.bs.modal",function(){j.destroy()});Vtiger_Edit_Js.getInstance().registerEvents();var i=f.find("form");i.validationEngine(app.validationEngineOptions);f.find('[name="saveButton"]').on("click",function(){if(i.validationEngine("validate")){var k={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",name:f.find('[name="name"]').val(),url:f.find('[name="addressUrl"]').val(),status:f.find('[name="status"]').is(":checked"),type:f.find(".typeServer").val(),pass:g.val(),accounts:f.find('[name="accountsid"]').val(),};if(d!=""){k.id=d}AppConnector.request(k).then(function(l){b.loadTable();app.hideModalWindow()})}})})})},registerCopyApiKey:function(){new ClipboardJS(".copyApiKey",{text:function(a){Vtiger_Helper_Js.showPnotify({text:app.vtranslate("JS_NOTIFY_COPY_TEXT"),type:"success"});return a.getAttribute("data-clipboard-text")}})},registerAddButton:function(){var a=this;$(".createKey").on("click",function(){a.showFormToEditKey()})},registerEvents:function(){this.registerAddButton();this.registerTableEvents();App.Fields.Password.registerCopyClipboard();this.registerCopyApiKey()}});