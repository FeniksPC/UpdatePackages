Vtiger_Edit_Js("OSSPasswords_Edit_Js",{},{registerRecordPreSaveEvent:function(form){var thisInstance=this;if(typeof form==="undefined"){form=this.getForm()}form.on(Vtiger_Edit_Js.recordPreSave,function(e,data){var password=form.find('[name="password"]').val();var id=form.find('[name="record"]').val();var params={};if(password==="**********"){params={};params.data={module:"OSSPasswords",action:"GetPass",record:id};params.async=false;AppConnector.request(params).then(function(data){var response=data["result"];if(response["success"]){var el=document.getElementById("OSSPasswords_editView_fieldName_password");el.value=response["password"];el.onchange()}});passwordStrength("","")}password=form.find('[name="password"]').val();params={};params.data={module:"OSSPasswords",action:"CheckPass",password:password,id:id};params.async=false;params.dataType="json";if(typeof thisInstance.passwordError==="undefined"||thisInstance.passwordError){e.preventDefault()}AppConnector.request(params).then(function(data){if(data.result.success===false){var params={text:data.result.message,sticker:false,sticker_hover:false,type:"error"};Vtiger_Helper_Js.showPnotify(params);thisInstance.sending=false;thisInstance.passwordError=true}else if(data.result.success===true&&(typeof thisInstance.sending==="undefined"||!thisInstance.sending)){thisInstance.sending=true;thisInstance.passwordError=false;form.submit()}})})},generatePassword:function(e){var element=jQuery(e.currentTarget);var form=element.closest("form");var min=parseInt(jQuery("#minChars").val());var max=parseInt(jQuery("#maxChars").val());var allowedChars=jQuery("#allowedLetters").val();var password="";if(typeof allowedChars==="undefined")allowedChars="!";var chArray=allowedChars.split(",");if(typeof min==="undefined")min=10;if(typeof max==="undefined")max=15;var passlength=parseInt(Math.random()*(max-min)+min);var i=0;for(i=0;i<=passlength;i++){var charIndex=parseInt(Math.random()*chArray.length);password+=chArray[charIndex]}var passForm=form.find('[name ="password"]');passForm.val(password);passForm.trigger("change")},registerButtonsEvents:function(){var thisInstance=this;$(".js-generatePass").on("click",function(e){thisInstance.generatePassword(e)})},registerBasicEvents:function(container){this._super(container);this.registerButtonsEvents();this.registerRecordPreSaveEvent(container)}});