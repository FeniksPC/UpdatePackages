Settings_Workflows_Edit_Js("Settings_Workflows_Edit2_Js",{},{step2Container:false,advanceFilterInstance:false,init:function(){this.initialize()},getContainer:function(){return this.step2Container},setContainer:function(element){this.step2Container=element;return this},initialize:function(container){if(typeof container==="undefined"){container=jQuery("#workflow_step2")}if(container.is("#workflow_step2")){this.setContainer(container)}else{this.setContainer(jQuery("#workflow_step2"))}},calculateValues:function(){var enableFilterElement=jQuery("#enableAdvanceFilters");if(enableFilterElement.length>0&&enableFilterElement.is(":checked")==false){jQuery("#advanced_filter").val(jQuery("#olderConditions").val())}else{jQuery('[name="filtersavedinnew"]').val("6");var advfilterlist=this.advanceFilterInstance.getValues();jQuery("#advanced_filter").val(JSON.stringify(advfilterlist))}},submit:function(){var aDeferred=jQuery.Deferred();var form=this.getContainer();this.calculateValues();var formData=form.serializeFormData();var progressIndicatorElement=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});AppConnector.request(formData).then(function(data){form.hide();if(data.result){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate("JS_WORKFLOW_SAVED_SUCCESSFULLY")});var workflowRecordElement=jQuery('[name="record"]',form);if(workflowRecordElement.val()==""){workflowRecordElement.val(data.result.id)}var params={module:app.getModuleName(),parent:app.getParentModuleName(),view:"Edit",mode:"step3",record:data.result.id};AppConnector.request(params).then(function(data){aDeferred.resolve(data)})}progressIndicatorElement.progressIndicator({mode:"hide"})},function(error,err){});return aDeferred.promise()},registerEnableFilterOption:function(){jQuery('[name="conditionstype"]').on("change",function(e){var advanceFilterContainer=jQuery("#advanceFilterContainer");var currentRadioButtonElement=jQuery(e.currentTarget);if(currentRadioButtonElement.hasClass("recreate")){if(currentRadioButtonElement.is(":checked")){advanceFilterContainer.removeClass("zeroOpacity")}}else{advanceFilterContainer.addClass("zeroOpacity")}})},registerEvents:function(){var opts=app.validationEngineOptions;opts["onValidationComplete"]=function(form,valid){return valid};opts["promptPosition"]="bottomRight";jQuery("#workflow_step2").validationEngine(opts);var container=this.getContainer();jQuery('button[type="submit"]',container).on("click",function(e){var fieldUiHolders=jQuery(".fieldUiHolder");for(var i=0;i<fieldUiHolders.length;i++){var fieldUiHolder=fieldUiHolders[i];var fieldValueElement=jQuery(".getPopupUi",fieldUiHolder);var valueType=jQuery('[name="valuetype"]',fieldUiHolder).val();if(valueType!="rawtext"){fieldValueElement.removeAttr("data-validation-engine");fieldValueElement.removeClass("validate[funcCall[Vtiger_Base_Validator_Js.invokeValidation]]")}}});App.Fields.Picklist.changeSelectElementView(container);this.advanceFilterInstance=Vtiger_AdvanceFilter_Js.getInstance(jQuery(".filterContainer",container));this.getPopUp();if(jQuery('[name="filtersavedinnew"]',container).val()=="5"){this.registerEnableFilterOption()}}});