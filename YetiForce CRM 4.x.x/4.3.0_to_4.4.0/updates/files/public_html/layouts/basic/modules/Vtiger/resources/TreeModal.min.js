$.Class("Base_TreeModal_JS",{},{selectEvent:false,container:false,tree:false,multiple:false,setSelectEvent:function(cb){this.selectEvent=cb},generateTree:function(){let plugins=[];if(this.multiple){plugins.push("category");plugins.push("checkbox")}this.tree.jstree({core:{data:JSON.parse(this.container.find(".js-tree-value").val()),themes:{name:"proton",responsive:true}},plugins:plugins})},registerSelectEvent:function(){if(this.multiple){this.container.find('[name="saveButton"]').on("click",()=>{let id=[],name=[];$.each(this.tree.jstree("getCategory",true),function(index,value){id.push("T"+value.id);name.push(value.text)});this.selectEvent({id:id.join(),name:name.join(", ")});app.hideModalWindow(false,this.container.parent().attr("id"))})}else{this.tree.on("select_node.jstree",(event,data)=>{this.selectEvent({id:"T"+data.node.id,name:data.node.text});app.hideModalWindow(false,this.container.parent().attr("id"))})}},registerEvents:function(modalContainer){this.container=modalContainer;this.tree=this.container.find(".js-tree-contents");this.multiple=this.container.find(".js-multiple").val()==1?true:false;this.generateTree();this.registerSelectEvent()}});